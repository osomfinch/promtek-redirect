<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Redirecting...</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #f0f0f0;
            display: none; /* Hide everything by default */
        }
    </style>
</head>
<body>
    <script>
        // Redirect immediately without showing anything
        const urlParams = new URLSearchParams(window.location.search);
        const folderPath = urlParams.get('path');
        
        if (folderPath) {
            const decodedPath = decodeURIComponent(folderPath);
            const oneDriveUrl = 'onedrive://path/' + encodeURIComponent(decodedPath);
            
            // Redirect instantly
            window.location.href = oneDriveUrl;
            
            // Try to close the tab quickly
            setTimeout(() => {
                window.close();
            }, 100);
        } else {
            // Only show body if there's an error
            document.body.style.display = 'block';
            document.body.innerHTML = '<p style="font-family: Arial; padding: 20px;">No folder path specified.</p>';
        }
    </script>
</body>
</html>
